<!DOCTYPE html>
<html lang="ko">
<!-- ì´ì „ í—¤ë“œ ì„¹ì…˜ê³¼ ìŠ¤íƒ€ì¼ì€ ë™ì¼ -->
<body>
    <!-- ë„¤ë¹„ê²Œì´ì…˜ ë°”ëŠ” ë©”ì¸ í˜ì´ì§€ì™€ ë™ì¼ -->

    <main class="main-content">
        <h1>ë‹¨ì–´ í•™ìŠµ</h1>

        <!-- í”Œë˜ì‹œì¹´ë“œ -->
        <div class="flashcard-container">
            <div class="flashcard" id="flashcard">
                <div class="flashcard-front">
                    ë‹¨ì–´ë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”
                </div>
                <div class="flashcard-back">
                    Add words to start
                </div>
            </div>
        </div>

        <!-- í•™ìŠµ ì»¨íŠ¸ë¡¤ -->
        <div class="study-controls" style="text-align: center; margin: 1rem 0;">
            <button onclick="previousCard()" class="nav-button">â¬…ï¸ ì´ì „</button>
            <button onclick="nextCard()" class="nav-button">ë‹¤ìŒ â¡ï¸</button>
        </div>

        <!-- ë‹¨ì–´ì¥ ê´€ë¦¬ -->
        <div class="vocabulary-manager">
            <h2>ë‚´ ë‹¨ì–´ì¥</h2>
            <div class="word-form">
                <input type="text" id="wordEn" placeholder="ì˜ì–´ ë‹¨ì–´">
                <input type="text" id="wordKo" placeholder="í•œê¸€ ëœ»">
                <button onclick="addWord()">ì¶”ê°€</button>
            </div>
            <ul class="word-list" id="wordList">
                <!-- ë™ì ìœ¼ë¡œ ì¶”ê°€ë¨ -->
            </ul>
        </div>

        <!-- í€´ì¦ˆ ëª¨ë“œ -->
        <div class="quiz-container">
            <h2>í€´ì¦ˆ ëª¨ë“œ</h2>
            <div id="quizContent" style="margin: 1rem 0;">
                <p id="quizQuestion">í€´ì¦ˆë¥¼ ì‹œì‘í•˜ë ¤ë©´ ë‹¨ì–´ë¥¼ ë¨¼ì € ì¶”ê°€í•´ì£¼ì„¸ìš”.</p>
                <div class="quiz-options">
                    <div class="quiz-option" onclick="checkAnswer(0)">ì˜µì…˜ 1</div>
                    <div class="quiz-option" onclick="checkAnswer(1)">ì˜µì…˜ 2</div>
                    <div class="quiz-option" onclick="checkAnswer(2)">ì˜µì…˜ 3</div>
                    <div class="quiz-option" onclick="checkAnswer(3)">ì˜µì…˜ 4</div>
                </div>
            </div>
            <button onclick="startQuiz()" class="start-quiz">í€´ì¦ˆ ì‹œì‘</button>
        </div>
    </main>

    <script>
        // ë‹¨ì–´ì¥ ë°ì´í„° ê´€ë¦¬
        let vocabulary = JSON.parse(localStorage.getItem('vocabulary')) || [];
        let currentCardIndex = 0;
        let quizMode = false;
        let currentQuiz = null;

        // í”Œë˜ì‹œì¹´ë“œ ë’¤ì§‘ê¸°
        const flashcard = document.getElementById('flashcard');
        flashcard.addEventListener('click', () => {
            if (!quizMode) {
                flashcard.classList.toggle('flipped');
            }
        });

        // ë‹¨ì–´ ì¶”ê°€ í•¨ìˆ˜
        function addWord() {
            const wordEn = document.getElementById('wordEn').value.trim();
            const wordKo = document.getElementById('wordKo').value.trim();
            
            if (wordEn && wordKo) {
                const newWord = { english: wordEn, korean: wordKo };
                vocabulary.push(newWord);
                localStorage.setItem('vocabulary', JSON.stringify(vocabulary));
                updateWordList();
                updateFlashcard();
                
                // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
                document.getElementById('wordEn').value = '';
                document.getElementById('wordKo').value = '';
            }
        }

        // ë‹¨ì–´ ì‚­ì œ í•¨ìˆ˜
        function deleteWord(index) {
            vocabulary.splice(index, 1);
            localStorage.setItem('vocabulary', JSON.stringify(vocabulary));
            updateWordList();
            updateFlashcard();
        }

        // ë‹¨ì–´ ëª©ë¡ ì—…ë°ì´íŠ¸
        function updateWordList() {
            const wordList = document.getElementById('wordList');
            wordList.innerHTML = '';
            
            vocabulary.forEach((word, index) => {
                const li = document.createElement('li');
                li.className = 'word-item';
                li.innerHTML = `
                    <span>${word.english} - ${word.korean}</span>
                    <button onclick="deleteWord(${index})">ì‚­ì œ</button>
                `;
                wordList.appendChild(li);
            });
        }

        // í”Œë˜ì‹œì¹´ë“œ ì—…ë°ì´íŠ¸
        function updateFlashcard() {
            if (vocabulary.length > 0) {
                const frontCard = flashcard.querySelector('.flashcard-front');
                const backCard = flashcard.querySelector('.flashcard-back');
                frontCard.textContent = vocabulary[currentCardIndex].english;
                backCard.textContent = vocabulary[currentCardIndex].korean;
            }
        }

        // ì´ì „/ë‹¤ìŒ ì¹´ë“œ ë„¤ë¹„ê²Œì´ì…˜
        function previousCard() {
            if (vocabulary.length > 0) {
                currentCardIndex = (currentCardIndex - 1 + vocabulary.length) % vocabulary.length;
                updateFlashcard();
                flashcard.classList.remove('flipped');
            }
        }

        function nextCard() {
            if (vocabulary.length > 0) {
                currentCardIndex = (currentCardIndex + 1) % vocabulary.length;
                updateFlashcard();
                flashcard.classList.remove('flipped');
            }
        }

        // í€´ì¦ˆ ëª¨ë“œ í•¨ìˆ˜ë“¤
        function startQuiz() {
            if (vocabulary.length < 4) {
                alert('í€´ì¦ˆ ëª¨ë“œë¥¼ ì‹œì‘í•˜ë ¤ë©´ ìµœì†Œ 4ê°œì˜ ë‹¨ì–´ê°€ í•„ìš”í•©ë‹ˆë‹¤.');
                return;
            }

            quizMode = true;
            generateQuizQuestion();
        }

        function generateQuizQuestion() {
            const question = vocabulary[Math.floor(Math.random() * vocabulary.length)];
            const options = [question.korean];
            
            // ì˜¤ë‹µ ë³´ê¸° ìƒì„±
            while (options.length < 4) {
                const wrongAnswer = vocabulary[Math.floor(Math.random() * vocabulary.length)].korean;
                if (!options.includes(wrongAnswer)) {
                    options.push(wrongAnswer);
                }
            }

            // ë³´ê¸° ì„ê¸°
            for (let i = options.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [options[i], options[j]] = [options[j], options[i]];
            }

            currentQuiz = {
                question: question.english,
                correct: question.korean,
                options: options
            };

            // í€´ì¦ˆ í™”ë©´ ì—…ë°ì´íŠ¸
            document.getElementById('quizQuestion').textContent = question.english;
            const optionElements = document.querySelectorAll('.quiz-option');
            optionElements.forEach((element, index) => {
                element.textContent = options[index];
            });
        }

        function checkAnswer(index) {
            if (!currentQuiz) return;

            const selected = currentQuiz.options[index];
            if (selected === currentQuiz.correct) {
                alert('ì •ë‹µì…ë‹ˆë‹¤! ğŸ‘');
                generateQuizQuestion();
            } else {
                alert('í‹€ë ¸ìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ë³´ì„¸ìš”! ğŸ’ª');
            }
        }

        // ì´ˆê¸° ë¡œë“œ
        updateWordList();
        updateFlashcard();
    </script>
</body>
</html>